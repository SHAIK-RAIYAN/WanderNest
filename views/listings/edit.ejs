<% layout('layouts/boilerplate') %>

<body id="internalPage" data-page="edit">
  <div class="container my-5">
    <div class="row justify-content-center">
      <div class="col-12 col-md-11 col-lg-9 col-xl-8">
        <!-- Card-like Form Box -->
        <div class="border border-secondary-subtle rounded p-4">
          <h1 class="mb-4">Edit Listing</h1>
          <form action="/listings/<%= listing._id %>?_method=PUT" method="POST" class="needs-validation" novalidate>
            <!-- Title -->
            <div class="mb-3">
              <label for="title" class="form-label">Title:</label>
              <input
                type="text"
                id="title"
                name="listing[title]"
                class="form-control"
                value="<%= listing.title %>"
                required />
                <div class="invalid-feedback">
                  Please enter a Title.
                </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label">Description:</label>
              <textarea
                id="description"
                name="listing[description]"
                rows="4"
                class="form-control"
                required>
<%= listing.description %></textarea
              >
              <div class="invalid-feedback">
                Please enter a Description.
              </div>
            </div>

            <!-- Price + Country on same row -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="price" class="form-label">Price (â‚¹):</label>
                <input
                  type="number"
                  id="price"
                  name="listing[price]"
                  class="form-control"
                  value="<%= listing.price %>"
                  required />
                  <div class="invalid-feedback">
                    Please enter a Price.
                  </div>
              </div>
              <div class="mb-3">
                <label for="country" class="form-label">Country:</label>
                <select
                  id="country"
                  name="listing[country]"
                  class="form-select"
                  required
                  data-selected-country="<%= listing.country %>">
                  <!-- Options will be populated via JS -->
                </select>
                <div class="invalid-feedback">
                  Please select a Country.
                </div>
              </div>
            </div>

            <!-- Image URL -->
            <div class="mb-3">
              <label for="image" class="form-label">Image URL:</label>
              <input
                type="text"
                id="image"
                name="listing[image][url]"
                class="form-control"
                value="<%= listing.image.url %>" />
                <div class="invalid-feedback">
                  Please provide a Image URL.
                </div>
            </div>

            <!-- Location -->
            <div class="mb-3">
              <label for="location" class="form-label">Location:</label>
              <input
                type="text"
                id="location"
                name="listing[location]"
                class="form-control"
                value="<%= listing.location %>"
                required />
                <div class="invalid-feedback">
                  Please enter a Location.
                </div>
            </div>

            <!-- Submit Button -->
            <div class="d-grid">
              <button type="submit" class="btn btn-dark fw-bold">
                Update Listing
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>
